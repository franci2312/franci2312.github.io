<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mastercom API</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="mastercom-internal-api-documentation">Mastercom internal api documentation</h1>
<p>Creata da franci2312, basata sull’app di Mastercom (it.mastercom.parents.app) e sulla documentazione interna fornita dall’endpoint usando OPTIONS e HEAD. Copyright 2020</p>
<h2 id="basi">Basi</h2>
<h3 id="sintassi">Sintassi</h3>
<p><code>{variabile}</code> indica una variabile ottenuta attraverso una richiesta api precedente<br>
<code>[variabile]</code> indica una variabile con valore a scelta dell’utente<br>
<code>&lt;variabile&gt;</code> indica una variabile statica (valore consultabile nell’indice finale)<br>
La sintassi per rappresentare il json è formattata come segue:<br>
l’oggetto base è chiamato <code>obj(id)</code> (object) e vari oggetti vengono rappresentati con un <code>.</code> e gli array con <code>[N]</code> (N indica un integer generico ma può essere sostituito da un numero, ciò indica un indice specifico) esempio: <code>obj(12A).studenti[0].2019_2020.foto</code> indica l’elemento <code>foto</code> con valore <code>img.jpg</code> contenuto nel json seguente</p>
<pre class=" language-json"><code class="prism  language-json"><span class="token punctuation">{</span>
  <span class="token string">"studenti"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">"2019_2020"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"foto"</span><span class="token punctuation">:</span> <span class="token string">"img.jpg"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"nome"</span><span class="token punctuation">:</span> <span class="token string">"mario"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token string">"2018_2019"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"foto"</span><span class="token punctuation">:</span> <span class="token string">"img2.jpg"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"cognome"</span><span class="token punctuation">:</span> <span class="token string">"rossi"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Ogni metodo api contiene all’inizio una tabella che fornisce informazioni di base sull’api simile a questa</p>

<table>
<thead>
<tr>
<th>Url</th>
<th>STUDENTE/example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>Sì (Usando <code>{Token}</code>)</td>
</tr>
<tr>
<td>Metodo</td>
<td>GET</td>
</tr>
<tr>
<td>Accetta</td>
<td>JSON, UrlEncoded</td>
</tr>
<tr>
<td>Ritorna</td>
<td>JSON + HTML</td>
</tr>
<tr>
<td>Funzione</td>
<td>Metodo di esempio</td>
</tr>
<tr>
<td>Dati</td>
<td><code>[dato1]</code> <code>[dato2]</code></td>
</tr>
</tbody>
</table><h3 id="endpoints">Endpoints</h3>
<p>L’url base è <code>https://mp.registroelettronico.com/</code> e verrà riferito sempre come <code>ROOT/</code>. L’api possiede vari endpoint. Quello più usato <code>ROOT/v2/</code> fornisce la maggior parte delle richieste dell’api. l’endpoint <code>ROOT/v2/scuole/&lt;Scuola&gt;/studenti/{studente}/{as}/</code> è usato per ottenere informazioni di uno studente e verrà chiamato <code>STUDENTE/</code>.</p>
<h3 id="lista-degli-endpoint-trovati">Lista degli endpoint trovati</h3>
<p>Da <code>ROOT/</code>:</p>
<ul>
<li><code>/utenti/login</code> (Autenticazione)</li>
<li><code>/utenti</code></li>
</ul>
<p>Da <code>STUDENTE/</code></p>
<ul>
<li><code>/aggiornamenti</code></li>
<li><code>/materie</code></li>
<li><code>/assenze</code></li>
<li><code>/voti</code></li>
<li><code>/note</code></li>
<li><code>/argomenti</code></li>
<li><code>/compiti</code></li>
<li><code>/agenda</code></li>
<li><code>/pagelle</code></li>
<li><code>/notizie</code> (Non funzionante)</li>
<li><code>/aggiornamenti</code></li>
<li><code>/allegati</code> (Funzionalità non chiara)</li>
<li><code>/orario</code></li>
<li><code>/comunicazioni</code></li>
<li><code>/comunicazioni/{id}</code></li>
<li><code>/colloqui</code> (Funzionalità non chiara)</li>
</ul>
<p>Non è ancora stato trovato l’endpoint per il reset della password, verrà temporaneamente indicato come <code>PWD/</code></p>
<h2 id="autenticazione">Autenticazione</h2>
<p>L’autenticazione è formata da 3 endpoint: <code>PWD/</code>, <code>ROOT/utenti/login</code> e <code>ROOT/utenti</code>.</p>
<h3 id="login">Login</h3>

<table>
<thead>
<tr>
<th>Url</th>
<th><code>ROOT/utenti/login</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>No</td>
</tr>
<tr>
<td>Metodo</td>
<td>POST</td>
</tr>
<tr>
<td>Accetta</td>
<td>JSON, UrlEncoded</td>
</tr>
<tr>
<td>Ritorna</td>
<td>JSON</td>
</tr>
<tr>
<td>Funzione</td>
<td>Login utente</td>
</tr>
<tr>
<td>Dati</td>
<td><code>[Username]</code> <code>[Password]</code> <code>&lt;Scuola&gt;</code></td>
</tr>
</tbody>
</table><p>Esempio <code>01</code>:</p>
<ul>
<li>Richiesta</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 01R</span>
<span class="token punctuation">{</span>
    <span class="token string">"scuola"</span><span class="token punctuation">:</span> <span class="token string">"&lt;Scuola&gt;"</span><span class="token punctuation">,</span>
    <span class="token string">"utente"</span><span class="token punctuation">:</span> <span class="token string">"[Username]"</span><span class="token punctuation">,</span>
    <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"[Password]"</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>Risposta:</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 01A</span>
<span class="token punctuation">{</span>
  <span class="token string">"token"</span><span class="token punctuation">:</span> <span class="token string">"abcdef"</span><span class="token punctuation">,</span> <span class="token comment">// Usato nell'auth come {token}</span>
  <span class="token string">"id_utente"</span><span class="token punctuation">:</span> <span class="token number">12345</span><span class="token punctuation">,</span>
  <span class="token string">"studenti"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token string">"nome"</span><span class="token punctuation">:</span> <span class="token string">"MARIO ROSSI"</span><span class="token punctuation">,</span>
      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token comment">// Usato in STUDENTE/ come {studente}</span>
      <span class="token string">"id_scuola"</span><span class="token punctuation">:</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token comment">// uguale a &lt;Scuola&gt;</span>
      <span class="token string">"foto"</span><span class="token punctuation">:</span> <span class="token string">"https://mp.registroelettronico.com/..."</span><span class="token punctuation">,</span>
      <span class="token string">"anno_corrente"</span><span class="token punctuation">:</span> <span class="token string">"2019_2020"</span><span class="token punctuation">,</span>
      <span class="token string">"anni"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"2019_2020"</span><span class="token punctuation">,</span> <span class="token comment">// Usato in STUDENTE/ come {as}</span>
          <span class="token string">"classe"</span><span class="token punctuation">:</span> <span class="token string">"1A"</span><span class="token punctuation">,</span>
          <span class="token string">"descrizione"</span><span class="token punctuation">:</span> <span class="token string">"2019/2020 ()"</span><span class="token punctuation">,</span>
          <span class="token string">"servizi"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token string">"agenda"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            <span class="token string">"alternanza"</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token operator">...</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">"servizi"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">"agenda"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">"alternanza"</span><span class="token punctuation">:</span> <span class="token boolean">false</span>
        <span class="token operator">...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="refresh-token">Refresh Token</h3>

<table>
<thead>
<tr>
<th>Url</th>
<th><code>ROOT/utenti/</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>No</td>
</tr>
<tr>
<td>Metodo</td>
<td>POST</td>
</tr>
<tr>
<td>Accetta</td>
<td>JSON, UrlEncoded</td>
</tr>
<tr>
<td>Ritorna</td>
<td>JSON</td>
</tr>
<tr>
<td>Funzione</td>
<td>Refresh token</td>
</tr>
<tr>
<td>Dati</td>
<td><code>{Token}</code></td>
</tr>
</tbody>
</table><p>Esempio <code>02</code>:</p>
<ul>
<li>Richiesta</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 02R</span>
<span class="token comment">// {Token} = obj(01A).token (string)</span>
<span class="token punctuation">{</span>
    <span class="token string">"token"</span><span class="token punctuation">:</span> <span class="token string">"{Token}"</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>Risposta:</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 02A</span>
<span class="token comment">// Risposta uguale a 01A, con token diverso</span>
<span class="token comment">// Il token precedente viene annullato</span>
</code></pre>
<h3 id="cambio-password---todo">Cambio password - TODO</h3>

<table>
<thead>
<tr>
<th>Url</th>
<th><code>PWD/</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>ND</td>
</tr>
<tr>
<td>Metodo</td>
<td>ND</td>
</tr>
<tr>
<td>Accetta</td>
<td>ND</td>
</tr>
<tr>
<td>Ritorna</td>
<td>ND</td>
</tr>
<tr>
<td>Funzione</td>
<td>Cambio password</td>
</tr>
<tr>
<td>Dati</td>
<td><code>[Old_password]</code> <code>[New_password]</code> <code>{Token}?</code></td>
</tr>
</tbody>
</table><p>Esempio <code>03</code>:</p>
<ul>
<li>Richiesta</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 03R</span>
TODO
</code></pre>
<ul>
<li>Risposta:</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 03A</span>
TODO
</code></pre>
<h3 id="autenticare-le-richieste">Autenticare le richieste</h3>
<p>Tutte le richieste che richiedono l’autenticazione via token vanno autenticate inserendo un header così formato:</p>

<table>
<thead>
<tr>
<th>Chiave</th>
<th>Valore</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authorization</td>
<td><code>JWT {Token}</code></td>
</tr>
</tbody>
</table><p>dove token è uguale a <code>obj(01A).token (string)</code></p>
<h2 id="costruzione-endpoint-studente">Costruzione endpoint STUDENTE/</h2>
<h3 id="dati-necessari">Dati necessari</h3>
<p><code>&lt;Scuola&gt;</code>: Vedi glossario oppure <code>obj(01A).studenti[N].id_scuola (integer)</code><br>
<code>{Studente}</code>  è uguale a <code>obj(01A).studenti[N].id (integer)</code><br>
<code>{as}</code> possiede 2 alternative:</p>
<ul>
<li><code>obj(01A).studenti[N].anno_corrente (string)</code></li>
<li><code>obj(01A).studenti[N].anni[N].id (string)</code></li>
<li>Composto da 2 anni consecutivi (Distanza 1) in formato <code>yyyy_yyyy</code> inseriti come segue <code>[AnnoMinore]_[AnnoMaggiore]</code></li>
</ul>
<h4 id="formato">Formato</h4>
<p>Il formato, indicato anche nella sezione <strong>Basi</strong> è come segue:<br>
<code>ROOT/v2/scuole/&lt;Scuola&gt;/studenti/{studente}/{as}/</code><br>
esempio url completo:<br>
<code>https://mp.registroelettronico.com/v2/scuole/1234/studenti/0001/2020_2021/</code><br>
Le richieste fatte a questo endpoint sono principalmente richieste GET, tranne in alcuni casi.</p>
<h2 id="informazioni-studente">Informazioni Studente</h2>
<p>La lista degli endpoint disponibili è contenuta in <strong>Lista degli endpoint trovati</strong>.</p>
<h3 id="aggiornamenti">Aggiornamenti</h3>

<table>
<thead>
<tr>
<th>Url</th>
<th><code>STUDENTE/aggiornamenti</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>Sì</td>
</tr>
<tr>
<td>Metodo</td>
<td>GET</td>
</tr>
<tr>
<td>Accetta</td>
<td></td>
</tr>
<tr>
<td>Ritorna</td>
<td>JSON</td>
</tr>
<tr>
<td>Funzione</td>
<td>Ottieni aggiornamenti</td>
</tr>
<tr>
<td>Dati</td>
<td></td>
</tr>
</tbody>
</table><p>Esempio <code>04</code>:</p>
<ul>
<li>Richiesta</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 04R</span>
<span class="token comment">// No dati</span>
</code></pre>
<ul>
<li>Risposta:</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 04A</span>
<span class="token punctuation">{</span>
  <span class="token string">"argomenti"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token string">"ISO8601 timestamp"</span><span class="token punctuation">,</span>
    <span class="token string">"numero"</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"voti"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token string">"ISO8601 timestamp"</span><span class="token punctuation">,</span>
    <span class="token string">"numero"</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"assenze"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token string">"ISO8601 timestamp"</span><span class="token punctuation">,</span>
    <span class="token string">"numero"</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span> <span class="token comment">// Ogni endpoint è associato ad un oggetto</span>
<span class="token punctuation">}</span>
<span class="token comment">//Esempio di ISO8601 timestamp:</span>
<span class="token comment">// 2020-01-02T10:30:45+01:00</span>
<span class="token comment">// Indica il 2 Gennaio 2020 alle ore 10:30:45 con fuso orario +1 ora </span>
</code></pre>
<h3 id="materie">Materie</h3>

<table>
<thead>
<tr>
<th>Url</th>
<th><code>STUDENTE/materie</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Auth</td>
<td>Sì</td>
</tr>
<tr>
<td>Metodo</td>
<td>GET</td>
</tr>
<tr>
<td>Accetta</td>
<td></td>
</tr>
<tr>
<td>Ritorna</td>
<td>JSON</td>
</tr>
<tr>
<td>Funzione</td>
<td>Ottieni materie</td>
</tr>
<tr>
<td>Dati</td>
<td></td>
</tr>
</tbody>
</table><p>Esempio <code>05</code>:</p>
<ul>
<li>Richiesta</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 05R</span>
<span class="token comment">// No dati</span>
</code></pre>
<ul>
<li>Risposta:</li>
</ul>
<pre class=" language-json"><code class="prism  language-json"><span class="token comment">// ID: 05A</span>
<span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
    <span class="token string">"descrizione"</span><span class="token punctuation">:</span> <span class="token string">"NOME MATERIA"</span><span class="token punctuation">,</span>
    <span class="token string">"ordinamento"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// Valore non utile</span>
    <span class="token string">"professori"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
        <span class="token string">"nome"</span><span class="token punctuation">:</span> <span class="token string">"NOME COGNOME"</span><span class="token punctuation">,</span>
        <span class="token string">"ordinamento"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Sempre uguale a 0</span>
        <span class="token string">"titolo"</span><span class="token punctuation">:</span> <span class="token string">"Docente"</span> <span class="token comment">// Sempre uguale a "Docente"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token operator">...</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span> <span class="token comment">//Ogni materia viene indicata</span>
<span class="token punctuation">]</span>
</code></pre>
</div>
</body>

</html>
